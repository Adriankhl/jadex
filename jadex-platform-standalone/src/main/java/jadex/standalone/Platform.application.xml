<?xml version="1.0" encoding="UTF-8"?>
<!--
  Bootstrap platform properties.
-->
<applicationtype xmlns="http://jadex.sourceforge.net/jadex-application"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex-application
						http://jadex.sourceforge.net/jadex-application-2.0.xsd"
	name="Platform" package="jadex.standalone">
	
	<imports>
		<import>jadex.commons.*</import>
		<import>jadex.bridge.*</import>
		<import>jadex.service.*</import>
		<import>jadex.service.clock.*</import>
		<import>jadex.service.execution.*</import>
		<import>jadex.service.library.*</import>
		<import>jadex.service.threadpool.*</import>
		<import>jadex.base.fipa.*</import>
		<import>jadex.base.*</import>
		<import>jadex.base.service.simulation.*</import>
		<import>jadex.commons.concurrent.*</import>
		<import>jadex.standalone.service.*</import>
		<import>jadex.standalone.transport.*</import>
		<import>jadex.standalone.transport.localmtp.*</import>
		<import>jadex.standalone.transport.tcpmtp.*</import>
		<import>jadex.standalone.transport.niotcpmtp.*</import>
		<import>jadex.application.*</import>
		<import>jadex.application.space.envsupport.*</import>
		<import>jadex.application.space.agr.*</import>
		<import>java.util.*</import>
	</imports>
	
	<arguments>
		<argument name="platformname">"lars"</argument>
		<argument name="autoshutdown">true</argument>
		<argument name="simulation">false</argument>
		<argument name="libpath"></argument>
		<argument name="tcpport">9876</argument>
		<argument name="niotcpport">8765</argument>
		
		<!-- todo?! -->
		<!-- <argument name="welcome">true</argument>
		<argument name="platform_shutdown_time">1000</argument> -->
	</arguments>
	
	<componenttypes>
		<componenttype filename="jadex/micro/KernelMicro.application.xml" name="kernel_micro"/>
		<componenttype filename="jadex/bdi/KernelBDI.application.xml" name="kernel_bdi"/>
		<componenttype filename="jadex/bdibpmn/KernelBDIBPMN.application.xml" name="kernel_bdibpmn"/>
		<componenttype filename="jadex/bpmn/KernelBPMN.application.xml" name="kernel_bpmn"/>
		<componenttype filename="jadex/base/service/remote/RemoteServiceManagementAgent.class" name="rms"/>

		<componenttype filename="jadex/tools/jcc/JCC.agent.xml" name="jcc"/>
		<componenttype filename="jadex/bdi/benchmarks/AgentCreation.agent.xml" name="CreationBDI"/>
		<componenttype filename="jadex/micro/benchmarks/AgentCreationAgent.class" name="CreationMicro"/>
		<componenttype filename="jadex/bpmn/benchmarks/AgentCreation2.bpmn" name="CreationBPMN"/>
	</componenttypes>
	
	<services>
		<!-- <container class="IServiceContainer">new ComponentServiceContainer($component.getComponentAdapter())</container>-->
		
		<service class="IThreadPoolService">
			new ThreadPoolService(new ThreadPool(new DefaultThreadPoolStrategy(0, 20, 30000)), $platform)
		</service>
		<service class="IExecutionService">
			$args.simulation
			? new SyncExecutionService($platform)
			: new AsyncExecutionService($platform)
			
			//$args.simulation
			//? new SyncExecutionService((IThreadPool)SServiceProvider.getService($platform, ThreadPoolService.class).get(new ThreadSuspendable()))
			//: new AsyncExecutionService((IThreadPool)SServiceProvider.getService($platform, ThreadPoolService.class).get(new ThreadSuspendable()))
		</service>
		<service class="ILibraryService">
			new LibraryService($args.libpath, $component.getComponentIdentifier())
		</service>
		<service class="IComponentManagementService">
			new ComponentManagementService($platform, $args.autoshutdown, $component.getComponentAdapter())
		</service>
		<service class="IDF">
			new DirectoryFacilitatorService($platform)
		</service>
		<service class="IMessageService">
			new MessageService($platform,
				new ITransport[]
				{
					new LocalTransport($platform),
					new TCPTransport($platform, $args.tcpport),
					new NIOTCPTransport($platform, $args.niotcpport)
				},
				new MessageType[]
				{
					new FIPAMessageType()
				})
		</service>
		<service class="IClockService">
			$args.simulation
			? new ClockService(new ClockCreationInfo(IClock.TYPE_EVENT_DRIVEN, "simulation_clock", System.currentTimeMillis(), 100), $platform)
			: new ClockService(new ClockCreationInfo(IClock.TYPE_SYSTEM, "simulation_clock", System.currentTimeMillis(), 100), $platform)

			// $args.simulation
			// ? new ClockService(new jadex.service.clock.SimulationEventClock("simulation_clock", System.currentTimeMillis(), 100))
			// : new ClockService(new SystemClock("system_clock", 100,
			//	(IThreadPool)SServiceProvider.getService($platform, ThreadPoolService.class).get(new ThreadSuspendable())))
		</service>
		<service class="ISimulationService">
			new SimulationService($platform)
		</service>
		<service class="jadex.bridge.IComponentFactory" >
			new ApplicationComponentFactory(
				new Set[]
				{
					MEnvSpaceType.getXMLMapping(),
					MAGRSpaceType.getXMLMapping()
				}, 
				$platform.getId()
			)		
		</service>
	</services>
	
	<applications>
		<application name="all_kernels_jcc">
			<components>
				<component name="kernel_micro" type="kernel_micro" daemon="true"/>
				<!-- <component type="kernel_bdi" daemon="true"/> -->
				<component name="kernel_bdibpmn" type="kernel_bdibpmn" daemon="true"/>
				<component name="kernel_bpmn" type="kernel_bpmn" daemon="true"/>
				<component name="rms" type="rms"/>
				<component name="jcc" type="jcc"/>
			</components>
		</application>
		
		<application name="all_kernels">
			<components>
				<component name="kernel_micro" type="kernel_micro"/>
				<!-- <component type="kernel_bdi"/> -->
				<component name="kernel_bdibpmn" type="kernel_bdibpmn"/>
				<component name="kernel_bpmn" type="kernel_bpmn"/>
				<component name="rms" type="rms"/>
			</components>
		</application>
		
		<application name="creation_test_bdi">
			<arguments>
				<argument name="libpath">new Object[]{"../jadex-applications-bdi/target/classes"}</argument>
			</arguments>
			<components>
				<component type="kernel_bdi"/>
				<component type="CreationBDI"/>
			</components>
		</application>
		
		<application name="creation_test_micro">
			<arguments>
				<argument name="libpath">new Object[]{"../jadex-applications-micro/target/classes"}</argument>
			</arguments>
			<components>
				<component type="kernel_micro"/>
				<component type="CreationMicro"/>
			</components>
		</application>

		<application name="creation_test_bpmn">
			<arguments>
				<argument name="libpath">new Object[]{"../jadex-applications-bpmn/target/classes"}</argument>
			</arguments>
			<components>
				<component type="kernel_bpmn"/>
				<component type="CreationBPMN"/>
			</components>
		</application>		
	</applications>
	
</applicationtype>