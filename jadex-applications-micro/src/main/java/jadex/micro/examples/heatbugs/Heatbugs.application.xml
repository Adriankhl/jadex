<!--
	<H3>The heatbugs application descriptor</H3>

	It can be started to launch a heatbugs scenario.
-->

<applicationtype xmlns="http://jadex.sourceforge.net/jadex-application"
	xmlns:env="http://jadex.sourceforge.net/jadex-envspace"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex-application 
	                    http://jadex.sourceforge.net/jadex-application-2.0.xsd
	                    http://jadex.sourceforge.net/jadex-envspace 
	                    http://jadex.sourceforge.net/jadex-envspace-2.0.xsd"
	name="Heatbugs" package="jadex.micro.examples.heatbugs">
	
	<imports>
		<import>jadex.adapter.base.envsupport.environment.space2d.*</import>
		<import>jadex.adapter.base.envsupport.environment.*</import>
		<import>jadex.adapter.base.envsupport.math.*</import>
		<import>jadex.adapter.base.envsupport.dataview.*</import>
		<import>jadex.adapter.base.envsupport.observer.perspective.*</import>
		<import>jadex.bdi.planlib.*</import>
	</imports>
	
	<spacetypes>
		<env:envspacetype name="gc2dspace" width="20" height="20" class="Grid2D">
			<env:property name="neighborhood">Grid2D.NEIGHBORHOOD_MOORE</env:property>
			<env:property name="min_ideal_temp">50.0</env:property>
			<env:property name="max_ideal_temp">100.0</env:property>
			<!-- <env:property name="min_ideal_temp">0</env:property>-->
			<!-- <env:property name="max_ideal_temp">200</env:property>-->
			<env:property name="min_output_heat">5.0</env:property>
			<env:property name="max_output_heat">25.0</env:property>
			<!-- <env:property name="min_output_heat">0</env:property> -->
			<!-- <env:property name="max_output_heat">100</env:property> -->
			<env:property name="diffusion_rate">0.2</env:property>
			<env:property name="evaporation_rate">0.03</env:property>
			<env:property name="random_move_chance">0.1</env:property>
			
			<env:objecttypes>
				<env:objecttype name="patch">
					<env:property name="heat">0.0</env:property>
				</env:objecttype>
				<env:objecttype name="heatbug">
					<env:property name="ideal_temp">$space.min_ideal_temp + Math.random()*($space.max_ideal_temp - $space.min_ideal_temp)</env:property>
					<env:property name="output_heat">$space.min_output_heat + Math.random()*($space.max_output_heat - $space.min_output_heat)</env:property>
					<env:property name="random_move_chance">$space.random_move_chance</env:property>
					<env:property name="unhappiness" dynamic="true">Math.abs($object.ideal_temp - ((Number)((ISpaceObject)((Grid2D)$space).getSpaceObjectsByGridPosition($object.position, "patch").iterator().next()).getProperty("heat")).doubleValue())</env:property>
				</env:objecttype>
			</env:objecttypes>
			
			<env:avatarmappings>
				<env:avatarmapping agenttype="Heatbug" objecttype="heatbug"/>
			</env:avatarmappings>
		
			<env:actiontypes>
				<env:actiontype name="move" class="MoveAction" />
			</env:actiontypes>
		
			<env:processtypes>
				<env:processtype name="diffuse" class="DiffusionProcess">
					<env:property name="diffusion_rate">$space.diffusion_rate</env:property>
					<env:property name="evaporation_rate">$space.evaporation_rate</env:property>
				</env:processtype>
			</env:processtypes>
			
			<env:views>
				<env:view name="view_all" class="GeneralDataView2D" />
			</env:views>
			
			<env:perspectives>
				<env:perspective name="main" class="Perspective2D" opengl="true" objectplacement="center">
					
					<env:drawable objecttype="patch" width="1.0" height="1.0">
						<env:property name="color" dynamic="true">new java.awt.Color((int)(Math.min(255, $object.heat)),0,0)</env:property>
						<env:rectangle color="color" />
					</env:drawable>
					
					<env:drawable objecttype="heatbug" width="0.5" height="0.5">
						<env:property name="color" dynamic="true">new java.awt.Color(0,(int)(Math.min(255, $object.ideal_temp)),255)</env:property>
						<env:rectangle color="color" />
					</env:drawable>
				
				</env:perspective>
			</env:perspectives>
			
			<env:spaceexecutor class="RoundBasedExecutor">
				<env:property name="space">$space</env:property>
			</env:spaceexecutor>
		</env:envspacetype>
	</spacetypes>
	
	<agenttypes>
		<agenttype name="Heatbug" filename="jadex/micro/examples/heatbugs/HeatbugAgent.class"/>
	</agenttypes>
	
	<applications>
		<application name="30x30">
			<spaces>
				<env:envspace name="mygc2dspace" type="gc2dspace" width="30" height="30">
					<env:processes>
						<env:process type="diffuse"/>
					</env:processes>
					
					<env:observers>
						<env:observer name="world" view="view_all" perspective="main"/>
					</env:observers>
				</env:envspace>
			</spaces>

			<agents>
				<agent type="Heatbug" number="40"/>
			</agents>
		</application>
		
		<application name="50x50">
			<spaces>
				<env:envspace name="mygc2dspace" type="gc2dspace" width="50" height="50">
					<env:processes>
						<env:process type="diffuse"/>
					</env:processes>
					
					<env:observers>
						<env:observer name="world" view="view_all" perspective="main"/>
					</env:observers>
				</env:envspace>
			</spaces>

			<agents>
				<agent type="Heatbug" number="100"/>
			</agents>
		</application>
	</applications>

</applicationtype>
