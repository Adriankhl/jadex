<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<semantic:definitions targetNamespace="http://www.activecomponents.org/bpmn/"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                      xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                      xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                      xmlns:semantic="http://www.omg.org/spec/BPMN/20100524/MODEL"
                      xmlns:jadex="http://www.activecomponents.org/bpmnextensions">
  <semantic:extension>
    <jadex:modelname>AgentCreation</jadex:modelname>
    <jadex:package>jadex.bpmn.benchmarks</jadex:package>
    <jadex:imports>
      <jadex:import>jadex.commons.*</jadex:import>
      <jadex:import>jadex.bridge.*</jadex:import>
      <jadex:import>jadex.bridge.modelinfo.*</jadex:import>
      <jadex:import>jadex.bpmn.runtime.task.*</jadex:import>
      <jadex:import>jadex.bpmn.model.*</jadex:import>
    </jadex:imports>
    <jadex:arguments>
      <jadex:argument name="max" type="int">
        <jadex:description>The maximum numbers of processes to create.</jadex:description>
        <jadex:value>10000</jadex:value>
      </jadex:argument>
      <jadex:argument name="num" type="int">
        <jadex:description>The current numbers of the process to create.</jadex:description>
        <jadex:value>1</jadex:value>
      </jadex:argument>
      <jadex:argument name="startmem" type="long">
        <jadex:value>Runtime.getRuntime().totalMemory()-Runtime.getRuntime().freeMemory()</jadex:value>
      </jadex:argument>
      <jadex:argument name="starttime" type="long">
        <jadex:value>null</jadex:value>
      </jadex:argument>
    </jadex:arguments>
    <jadex:contextvariables>
      <jadex:contextvariable name="starttime" type="long">
        <jadex:value> System.currentTimeMillis()</jadex:value>
      </jadex:contextvariable>
    </jadex:contextvariables>
    <jadex:configurations>
      <jadex:configuration name="Pool">
      </jadex:configuration>
    </jadex:configurations>
  </semantic:extension>
  <semantic:process name="Pool" id="_EA9-sdQbEd6ZgonVFJzeWg">
    <semantic:task name="Dispatch Subprocess and Wait For Result" id="_ZBsF0dQjEd6ZgonVFJzeWg">
      <semantic:incoming>_ZB1PwdQjEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:outgoing>_jdMVStXtEd6ZgonVFJzeWg</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>CreateComponentTask</jadex:taskclass>
        <jadex:parameter direction="in" name="model" type="java.lang.String">"/jadex/bpmn/benchmarks/AgentCreation.bpmn"</jadex:parameter>
        <jadex:parameter direction="in" name="name" type="java.lang.String">"AgentCreation_#"+(num+1)</jadex:parameter>
        <jadex:parameter direction="in" name="num" type="java.lang.Integer">new Integer(num +1)</jadex:parameter>
        <jadex:parameter direction="in" name="startmem" type="java.lang.Long">startmem</jadex:parameter>
        <jadex:parameter direction="in" name="starttime" type="java.lang.Long">starttime</jadex:parameter>
        <jadex:parameter direction="in" name="max" type="java.lang.Long">max</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:startEvent id="_185DIdQeEd6ZgonVFJzeWg">
      <semantic:outgoing>_2jKY8dQeEd6ZgonVFJzeWg</semantic:outgoing>
    </semantic:startEvent>
    <semantic:task name="Fetch and prepare arguments" id="_nFusgdQcEd6ZgonVFJzeWg">
      <semantic:incoming>_2jKY8dQeEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:outgoing>_WJi0AdQjEd6ZgonVFJzeWg</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>PrintTask</jadex:taskclass>
        <jadex:parameter direction="in" name="text" type="java.lang.String">"Created peer: "+num</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:exclusiveGateway id="_WJZDAdQjEd6ZgonVFJzeWg" default="_PYI8MdQkEd6ZgonVFJzeWg">
      <semantic:incoming>_WJi0AdQjEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:outgoing>_ZB1PwdQjEd6ZgonVFJzeWg</semantic:outgoing>
      <semantic:outgoing>_PYI8MdQkEd6ZgonVFJzeWg</semantic:outgoing>
    </semantic:exclusiveGateway>
    <semantic:task name="Print Kill Results Task" id="_jQRI0dg4Ed6ZgonVFJzeWg">
      <semantic:incoming>_jQa50dg4Ed6ZgonVFJzeWg</semantic:incoming>
      <semantic:outgoing>_qyK0Adg4Ed6ZgonVFJzeWg</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>PrintTask</jadex:taskclass>
        <jadex:parameter direction="in" name="dur" type="double">dur</jadex:parameter>
        <jadex:parameter direction="in" name="pera" type="double">pera</jadex:parameter>
        <jadex:parameter direction="in" name="omem" type="long">omem</jadex:parameter>
        <jadex:parameter direction="in" name="upera" type="double">upera</jadex:parameter>
        <jadex:parameter direction="in" name="killdur" type="double">((double)System.currentTimeMillis()-killstarttime)/1000.0</jadex:parameter>
        <jadex:parameter direction="in" name="killpera" type="double">killdur/(max-1)</jadex:parameter>
        <jadex:parameter direction="in" name="stillused" type="long">(Runtime.getRuntime().totalMemory()-Runtime.getRuntime().freeMemory())/1024</jadex:parameter>
        <jadex:parameter direction="in" name="text" type="java.lang.String">"Last peer destroyed. "+(max-1)+" components killed. \n\nCumulated results:\nCreation needed: "+dur+" secs. Per component: "+pera+" sec. Corresponds to "+(1/pera)+" components per sec.\nKilling needed:  "+killdur+" secs. Per process: "+killpera+" sec. Corresponds to "+(1/killpera)+" components per sec.\nOverall memory usage: "+omem+"kB. Per component: "+upera+" kB.\nStill used memory: "+stillused+"kB."</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:endEvent id="_i5aRgdQmEd6ZgonVFJzeWg">
      <semantic:incoming>_qyK0Adg4Ed6ZgonVFJzeWg</semantic:incoming>
    </semantic:endEvent>
    <semantic:task name="Print Creation Results Task" id="_PX_yQdQkEd6ZgonVFJzeWg">
      <semantic:incoming>_PYI8MdQkEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:outgoing>_D9m9IdQlEd6ZgonVFJzeWg</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>PrintTask</jadex:taskclass>
        <jadex:parameter direction="in" name="used" type="long">Runtime.getRuntime().totalMemory()-Runtime.getRuntime().freeMemory()</jadex:parameter>
        <jadex:parameter direction="inout" name="omem" type="long">(used-startmem)/1024</jadex:parameter>
        <jadex:parameter direction="inout" name="upera" type="double">((long)(1000*(used-startmem)/max/1024))/1000.0</jadex:parameter>
        <jadex:parameter direction="in" name="end" type="long">System.currentTimeMillis()</jadex:parameter>
        <jadex:parameter direction="inout" name="dur" type="double">((double)end-starttime)/1000.0</jadex:parameter>
        <jadex:parameter direction="inout" name="pera" type="double">dur/max</jadex:parameter>
        <jadex:parameter direction="in" name="text" type="java.lang.String">"Overall memory usage: "+omem+"kB. Per process: "+upera+" kB.\nLast peer created. "+max+" processes started.\nNeeded: "+dur+" secs. Per process: "+pera+" sec. Corresponds to "+(1/pera)+" processes per sec."</jadex:parameter>
        <jadex:parameter direction="inout" name="killstarttime" type="long">System.currentTimeMillis()</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:intermediateCatchEvent name="Wait For Ever" id="_jdMVQdXtEd6ZgonVFJzeWg">
      <semantic:incoming>_jdMVStXtEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:signalEventDefinition/>
    </semantic:intermediateCatchEvent>
    <semantic:task name="Delete Peers" id="_D9dzMdQlEd6ZgonVFJzeWg">
      <semantic:incoming>_D9m9IdQlEd6ZgonVFJzeWg</semantic:incoming>
      <semantic:incoming>_reiwMdYnEd6H3v0lpmo8zA</semantic:incoming>
      <semantic:outgoing>_ooq7WmJ5Ed-Q9q1HfsZXQw</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>DestroyComponentTask</jadex:taskclass>
        <jadex:parameter direction="inout" name="dur" type="double">dur</jadex:parameter>
        <jadex:parameter direction="inout" name="pera" type="double">pera</jadex:parameter>
        <jadex:parameter direction="inout" name="omem" type="long">omem</jadex:parameter>
        <jadex:parameter direction="inout" name="upera" type="double">upera</jadex:parameter>
        <jadex:parameter direction="inout" name="i" type="int">max-1</jadex:parameter>
        <jadex:parameter direction="inout" name="name" type="java.lang.String">i==1? "AgentCreation": "AgentCreation_#"+i</jadex:parameter>
        <jadex:parameter direction="inout" name="killstarttime" type="long">killstarttime</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:task name="Print Deletion" id="_ooq7UWJ5Ed-Q9q1HfsZXQw">
      <semantic:incoming>_ooq7WmJ5Ed-Q9q1HfsZXQw</semantic:incoming>
      <semantic:outgoing>_oJRdgdYnEd6H3v0lpmo8zA</semantic:outgoing>
      <semantic:extensionElements>
        <jadex:taskclass>PrintTask</jadex:taskclass>
        <jadex:parameter direction="inout" name="dur" type="double">dur</jadex:parameter>
        <jadex:parameter direction="inout" name="pera" type="double">pera</jadex:parameter>
        <jadex:parameter direction="inout" name="omem" type="long">omem</jadex:parameter>
        <jadex:parameter direction="inout" name="upera" type="double">upera</jadex:parameter>
        <jadex:parameter direction="inout" name="i" type="int">i</jadex:parameter>
        <jadex:parameter direction="in" name="text" type="java.lang.String">"Successfully destroyed peer "+name</jadex:parameter>
        <jadex:parameter direction="inout" name="killstarttime" type="long">killstarttime</jadex:parameter>
      </semantic:extensionElements>
    </semantic:task>
    <semantic:exclusiveGateway id="_oIxuQdYnEd6H3v0lpmo8zA" default="_jQa50dg4Ed6ZgonVFJzeWg">
      <semantic:incoming>_oJRdgdYnEd6H3v0lpmo8zA</semantic:incoming>
      <semantic:outgoing>_reiwMdYnEd6H3v0lpmo8zA</semantic:outgoing>
      <semantic:outgoing>_jQa50dg4Ed6ZgonVFJzeWg</semantic:outgoing>
    </semantic:exclusiveGateway>
    <semantic:sequenceFlow sourceRef="_ZBsF0dQjEd6ZgonVFJzeWg" targetRef="_jdMVQdXtEd6ZgonVFJzeWg" id="_jdMVStXtEd6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_185DIdQeEd6ZgonVFJzeWg" targetRef="_nFusgdQcEd6ZgonVFJzeWg" id="_2jKY8dQeEd6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_nFusgdQcEd6ZgonVFJzeWg" targetRef="_WJZDAdQjEd6ZgonVFJzeWg" id="_WJi0AdQjEd6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_WJZDAdQjEd6ZgonVFJzeWg" targetRef="_ZBsF0dQjEd6ZgonVFJzeWg" id="_ZB1PwdQjEd6ZgonVFJzeWg">
      <semantic:conditionExpression>num&lt;max</semantic:conditionExpression>
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_WJZDAdQjEd6ZgonVFJzeWg" targetRef="_PX_yQdQkEd6ZgonVFJzeWg" id="_PYI8MdQkEd6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_jQRI0dg4Ed6ZgonVFJzeWg" targetRef="_i5aRgdQmEd6ZgonVFJzeWg" id="_qyK0Adg4Ed6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_PX_yQdQkEd6ZgonVFJzeWg" targetRef="_D9dzMdQlEd6ZgonVFJzeWg" id="_D9m9IdQlEd6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_D9dzMdQlEd6ZgonVFJzeWg" targetRef="_ooq7UWJ5Ed-Q9q1HfsZXQw" id="_ooq7WmJ5Ed-Q9q1HfsZXQw">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_ooq7UWJ5Ed-Q9q1HfsZXQw" targetRef="_oIxuQdYnEd6H3v0lpmo8zA" id="_oJRdgdYnEd6H3v0lpmo8zA">
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_oIxuQdYnEd6H3v0lpmo8zA" targetRef="_D9dzMdQlEd6ZgonVFJzeWg" id="_reiwMdYnEd6H3v0lpmo8zA">
      <semantic:conditionExpression>i > 1</semantic:conditionExpression>
      <semantic:extensionElements>
        <jadex:parametermapping name="i">i-1</jadex:parametermapping>
      </semantic:extensionElements>
    </semantic:sequenceFlow>
    <semantic:sequenceFlow sourceRef="_oIxuQdYnEd6H3v0lpmo8zA" targetRef="_jQRI0dg4Ed6ZgonVFJzeWg" id="_jQa50dg4Ed6ZgonVFJzeWg">
    </semantic:sequenceFlow>
    <semantic:extensionElements>
    </semantic:extensionElements>
  </semantic:process>
  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane>
      <bpmndi:BPMNShape bpmnElement="_EA9-sdQbEd6ZgonVFJzeWg">
        <dc:Bounds height="600.0" width="3000.0" x="0.0" y="0.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_ZBsF0dQjEd6ZgonVFJzeWg">
        <dc:Bounds height="100.0" width="160.0" x="530.0" y="0.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_185DIdQeEd6ZgonVFJzeWg">
        <dc:Bounds height="40.0" width="40.0" x="70.0" y="150.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_nFusgdQcEd6ZgonVFJzeWg">
        <dc:Bounds height="100.0" width="160.0" x="220.0" y="120.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_WJZDAdQjEd6ZgonVFJzeWg">
        <dc:Bounds height="60.0" width="60.0" x="420.0" y="140.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_jQRI0dg4Ed6ZgonVFJzeWg">
        <dc:Bounds height="100.0" width="160.0" x="1760.0" y="200.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_i5aRgdQmEd6ZgonVFJzeWg">
        <dc:Bounds height="40.0" width="40.0" x="2010.0" y="230.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_PX_yQdQkEd6ZgonVFJzeWg">
        <dc:Bounds height="100.0" width="160.0" x="530.0" y="120.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_jdMVQdXtEd6ZgonVFJzeWg">
        <dc:Bounds height="40.0" width="40.0" x="790.0" y="30.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_D9dzMdQlEd6ZgonVFJzeWg">
        <dc:Bounds height="100.0" width="160.0" x="940.0" y="120.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_ooq7UWJ5Ed-Q9q1HfsZXQw">
        <dc:Bounds height="100.0" width="160.0" x="1270.0" y="120.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_oIxuQdYnEd6H3v0lpmo8zA">
        <dc:Bounds height="60.0" width="60.0" x="1560.0" y="140.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_2jKY8dQeEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_WJi0AdQjEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_ZB1PwdQjEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_PYI8MdQkEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_D9m9IdQlEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_jdMVStXtEd6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_oJRdgdYnEd6H3v0lpmo8zA">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_reiwMdYnEd6H3v0lpmo8zA">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_jQa50dg4Ed6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_qyK0Adg4Ed6ZgonVFJzeWg">
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_ooq7WmJ5Ed-Q9q1HfsZXQw">
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</semantic:definitions>

