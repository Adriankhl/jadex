<!--
	Basic Capability for WFMS client applications.
-->
<capability xmlns="http://jadex.sourceforge.net/jadex-bdi"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex-bdi
	                    http://jadex.sourceforge.net/jadex-bdi-2.0.xsd"
	package="jadex.wfms.bdi.client.cap"
	name="wfmsclient">
	
	<imports>
		<import>java.util.*</import>
		<import>jadex.wfms.bdi.*</import>
		<import>jadex.wfms.bdi.ontology.*</import>
		<import>jadex.wfms.client.*</import>
	</imports>
	
	<capabilities>
		<capability name="dfcap" file="jadex.bdi.planlib.df.DF"/>
		<capability name="reqcap" file="jadex.bdi.planlib.protocols.request.Request"/>
		<capability name="subcap" file="jadex.bdi.planlib.protocols.subscribe.Subscribe"/>
	</capabilities>
	
	<beliefs>
		<beliefref name="rp_filter">
			<concrete ref="reqcap.rp_filter"/>
		</beliefref>
		<beliefref name="rp_timeout">
			<concrete ref="reqcap.timeout"/>
		</beliefref>
		<belief name="add_workitem_controller" class="javax.swing.Action" />
		<belief name="remove_workitem_controller" class="javax.swing.Action" />
		<belief name="add_activity_controller" class="javax.swing.Action" />
		<belief name="remove_activity_controller" class="javax.swing.Action" />
		<belief name="add_user_activity_controller" class="javax.swing.Action" />
		<belief name="remove_user_activity_controller" class="javax.swing.Action" />
		<belief name="lost_connection_controller" class="javax.swing.Action" />
	</beliefs>
	
	<goals>
		<achievegoal name="connect" exported="true">
			<parameter name="user_name" class="String" />
			<parameter name="auth_token" class="Object" />
			<parameter name="capabilities" class="Set" direction="out" />
		</achievegoal>
		
		<achievegoal name="disconnect" exported="true">
			<parameter name="user_name" class="String" />
		</achievegoal>
		
		<achievegoal name="request_model_names" exported="true">
			<parameter name="model_names" class="Set" direction="out" />
		</achievegoal>
		
		<achievegoal name="start_process" exported="true">
			<parameter name="process_name" class="String" />
		</achievegoal>
		
		<achievegoal name="add_process" exported="true">
			<parameter name="process_path" class="String" />
		</achievegoal>
		
		<achievegoal name="request_workitem_list" exported="true">
			<parameter name="workitem_list" class="Set" direction="out" />
		</achievegoal>
		
		<achievegoal name="request_activity_list" exported="true">
			<parameter name="activity_list" class="Set" direction="out" />
		</achievegoal>
		
		<achievegoal name="begin_activity" exported="true">
			<parameter name="workitem" class="IWorkitem" />
			<parameter name="activity" class="IClientActivity" direction="out" />
		</achievegoal>
		
		<achievegoal name="cancel_activity" exported="true">
			<parameter name="activity" class="IClientActivity" />
		</achievegoal>
		
		<achievegoal name="finish_activity" exported="true">
			<parameter name="activity" class="IClientActivity" />
		</achievegoal>
		
		
		<achievegoal name="start_workitem_subscription" exported="true" />
		
		<achievegoal name="start_activity_subscription" exported="true" />
		
		
		<!--======================= Administration =====================-->
		
		<achievegoal name="request_user_activities" exported="true">
			<parameter name="user_activities" class="Set" direction="out" />
		</achievegoal>
		
		<achievegoal name="terminate_activity" exported="true">
			<parameter name="activity" class="IClientActivity" direction="in" />
		</achievegoal>
		
		<achievegoal name="start_user_activities_subscription" exported="true" />
		
		<!-- ================= Subscription Events ==================== -->
		<achievegoal name="add_workitem" exported="true">
			<parameter name="workitem" class="IWorkitem" exported="true" />
		</achievegoal>
		
		<achievegoal name="remove_workitem" exported="true">
			<parameter name="workitem" class="IWorkitem" exported="true"/>
		</achievegoal>
		
		<achievegoal name="add_activity" exported="true">
			<parameter name="activity" class="IClientActivity" exported="true" />
		</achievegoal>
		
		<achievegoal name="remove_activity" exported="true">
			<parameter name="activity" class="IClientActivity" exported="true"/>
		</achievegoal>
		
		<achievegoal name="add_user_activity" exported="true">
			<parameter name="user_name" class="String" exported="true" />
			<parameter name="activity" class="IClientActivity" exported="true" />
		</achievegoal>
		
		<achievegoal name="remove_user_activity" exported="true">
			<parameter name="user_name" class="String" exported="true" />
			<parameter name="activity" class="IClientActivity" exported="true"/>
		</achievegoal>
		
		<!-- ================= Heartbeat/Keepalive goals ==================== -->
		<achievegoal name="recover_lost_connection" exported="true" />
		
		<performgoal name="keep_sending_heartbeats" retry="true" retrydelay="2000" exclude="never"/>
	</goals>
	
	<plans>
		<plan name="connect_plan">
			<parameter name="user_name" class="String">
				<goalmapping ref="connect.user_name"/>
			</parameter>
			<parameter name="auth_token" class="Object">
				<goalmapping ref="connect.auth_token"/>
			</parameter>
			<parameter name="capabilities" class="Set" direction="out">
				<goalmapping ref="connect.capabilities"/>
			</parameter>
			<body class="ConnectPlan" />
			<trigger>
				<goal ref="connect" />
			</trigger>
		</plan>
		
		<plan name="disconnect_plan">
			<parameter name="user_name" class="String">
				<goalmapping ref="disconnect.user_name"/>
			</parameter>
			<body class="DisconnectPlan" />
			<trigger>
				<goal ref="disconnect" />
			</trigger>
		</plan>
		
		<plan name="request_model_names_plan">
			<parameter name="model_names" class="Set" direction="out">
				<goalmapping ref="request_model_names.model_names"/>
			</parameter>
			<body class="ModelNamesPlan" />
			<trigger>
				<goal ref="request_model_names" />
			</trigger>
		</plan>
		
		<plan name="start_process_plan">
			<parameter name="process_name" class="String">
				<goalmapping ref="start_process.process_name"/>
			</parameter>
			<body class="StartProcessPlan" />
			<trigger>
				<goal ref="start_process" />
			</trigger>
		</plan>
		
		<plan name="add_process_plan">
			<parameter name="process_path" class="String">
				<goalmapping ref="add_process.process_path"/>
			</parameter>
			<body class="AddProcessPlan" />
			<trigger>
				<goal ref="add_process" />
			</trigger>
		</plan>
		
		<plan name="request_workitem_list_plan">
			<parameter name="workitem_list" class="Set" direction="out">
				<goalmapping ref="request_workitem_list.workitem_list"/>
			</parameter>
			<body class="WorkitemListPlan" />
			<trigger>
				<goal ref="request_workitem_list" />
			</trigger>
		</plan>
		
		<plan name="request_activity_list_plan">
			<parameter name="activity_list" class="Set" direction="out">
				<goalmapping ref="request_activity_list.activity_list"/>
			</parameter>
			<body class="ActivityListPlan" />
			<trigger>
				<goal ref="request_activity_list" />
			</trigger>
		</plan>
		
		<plan name="begin_activity_plan">
			<parameter name="workitem" class="IWorkitem">
				<goalmapping ref="begin_activity.workitem"/>
			</parameter>
			<parameter name="activity" class="IClientActivity" direction="out">
				<goalmapping ref="begin_activity.activity"/>
			</parameter>
			<body class="BeginActivityPlan" />
			<trigger>
				<goal ref="begin_activity" />
			</trigger>
		</plan>
		
		<plan name="cancel_activity_plan">
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="begin_activity.activity"/>
			</parameter>
			<body class="CancelActivityPlan" />
			<trigger>
				<goal ref="cancel_activity" />
			</trigger>
		</plan>
		
		<plan name="finish_activity_plan">
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="finish_activity.activity"/>
			</parameter>
			<body class="FinishActivityPlan" />
			<trigger>
				<goal ref="finish_activity" />
			</trigger>
		</plan>
		
		<plan name="request_user_activities_plan">
			<parameter name="user_activities" class="Set" direction="out">
				<goalmapping ref="request_user_activities.user_activities"/>
			</parameter>
			<body class="UserActivitiesPlan" />
			<trigger>
				<goal ref="request_user_activities" />
			</trigger>
		</plan>
		
		<plan name="terminate_activity_plan">
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="terminate_activity.activity"/>
			</parameter>
			<body class="TerminateActivityPlan" />
			<trigger>
				<goal ref="terminate_activity" />
			</trigger>
		</plan>
		
		<plan name="start_user_activities_subscription_plan">
			<body class="UserActivitiesSubscriptionPlan" />
			<trigger>
				<goal ref="start_user_activities_subscription" />
			</trigger>
		</plan>
		
		
		<plan name="start_workitem_subscription_plan">
			<body class="WorkitemSubscriptionPlan" />
			<trigger>
				<goal ref="start_workitem_subscription" />
			</trigger>
		</plan>
		
		<plan name="start_activity_subscription_plan">
			<body class="ActivitySubscriptionPlan" />
			<trigger>
				<goal ref="start_activity_subscription" />
			</trigger>
		</plan>
		
		<plan name="keep_sending_heartbeats_plan">
			<body class="SendHeartbeatPlan"/>
			<trigger>
				<goal ref="keep_sending_heartbeats"/>
			</trigger>
		</plan>
		
		<plan name="subscription_update_plan">
			<parameter name="update" class="Object">
				<goalmapping ref="subcap.sp_handle_update.update"/>
			</parameter>
			<parameter name="subscription_id" class="Object">
				<goalmapping ref="subcap.sp_handle_update.subscription_id"/>
			</parameter>
			<body class="SubscriptionUpdatePlan" />
			<trigger>
				<goal ref="subcap.sp_handle_update" />
			</trigger>
		</plan>
		
		<plan name="add_workitem_plan" priority="-1">
			<parameter name="workitem" class="IWorkitem">
				<goalmapping ref="add_workitem.workitem"/>
			</parameter>
			<body class="AddWorkitemPlan" />
			<trigger>
				<goal ref="add_workitem" />
			</trigger>
		</plan>
		
		<plan name="remove_workitem_plan" priority="-1">
			<parameter name="workitem" class="IWorkitem">
				<goalmapping ref="remove_workitem.workitem"/>
			</parameter>
			<body class="RemoveWorkitemPlan" />
			<trigger>
				<goal ref="remove_workitem" />
			</trigger>
		</plan>
		
		<plan name="add_activity_plan" priority="-1">
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="add_activity.activity"/>
			</parameter>
			<body class="AddActivityPlan" />
			<trigger>
				<goal ref="add_activity" />
			</trigger>
		</plan>
		
		<plan name="remove_activity_plan" priority="-1">
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="remove_activity.activity"/>
			</parameter>
			<body class="RemoveActivityPlan" />
			<trigger>
				<goal ref="remove_activity" />
			</trigger>
		</plan>
		
		<plan name="add_user_activity_plan" priority="-1">
			<parameter name="user_name" class="String">
				<goalmapping ref="add_user_activity.user_name"/>
			</parameter>
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="add_activity.activity"/>
			</parameter>
			<body class="AddUserActivityPlan" />
			<trigger>
				<goal ref="add_user_activity" />
			</trigger>
		</plan>
		
		<plan name="remove_user_activity_plan" priority="-1">
			<parameter name="user_name" class="String">
				<goalmapping ref="remove_user_activity.user_name"/>
			</parameter>
			<parameter name="activity" class="IClientActivity">
				<goalmapping ref="remove_activity.activity"/>
			</parameter>
			<body class="RemoveUserActivityPlan" />
			<trigger>
				<goal ref="remove_user_activity" />
			</trigger>
		</plan>
		
		<plan name="lost_connection_plan" priority="-1">
			<body class="LostConnectionPlan" />
			<trigger>
				<goal ref="recover_lost_connection" />
			</trigger>
		</plan>
	</plans>
	
	<events>
	</events>
	
	<configurations>
		<configuration name="default">
			<beliefs>
				<initialbelief ref="rp_filter">
					<fact>jadex.commons.IFilter.ALWAYS</fact>
				</initialbelief>
				<initialbelief ref="rp_timeout">
					<fact>2000L</fact>
				</initialbelief>
			</beliefs>
		</configuration>
	</configurations>
	
</capability>