<?xml version="1.0" encoding="UTF-8"?>
<agent xmlns="http://jadex.sourceforge.net/jadex"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex
	                    http://jadex.sourceforge.net/jadex-bdi-2.0.xsd"
	name="Verkehrsteilnehmer" package="sodekovs.bikesharing.verkehrsteilnehmer">

	<imports>
		<import>jadex.extension.envsupport.math.Vector2Int</import>
		<import>jadex.extension.envsupport.math.IVector2</import>
		<import>jadex.extension.envsupport.math.Vector2Double</import>		
		<import>jadex.extension.envsupport.environment.space2d.Grid2D</import>
		<import>jadex.extension.envsupport.environment.ISpaceObject</import>
		<import>jadex.commons.future.IFuture</import>
		<import>sodekovs.bikesharing.container.*</import>
		<import>sodekovs.bikesharing.zeit.Zeitverwaltung</import>
	</imports>

	<beliefs>
		<belief name="space" class="Grid2D">
			<fact class="IFuture">$scope.getParentAccess().getExtension("simulationsspace")</fact>		
		</belief>
		<belief name="avatar" class="ISpaceObject">
			<fact>$beliefbase.space.getAvatar($scope.getComponentDescription(), $scope.getAgentModel().getFullName())</fact>		
		</belief>
		<beliefset name="wege" class="VerkehrsteilnehmerWeg"/>
		<belief name="weganzahl" class="Integer"><fact>new Integer(0)</fact></belief>
		<belief name="risikopraeferenz" class="java.lang.Double"><fact>new java.lang.Double(1.0)</fact></belief>
		<belief name="maximalerFussweg" class="java.lang.Double"><fact>new java.lang.Double(5.0)</fact></belief>
		<belief name="fahrradpraeferenz" class="java.lang.Double"><fact>new java.lang.Double(0.6)</fact></belief>
		<belief name="laufpraeferenz" class="java.lang.Double"><fact>new java.lang.Double(0.6)</fact></belief>
		<belief name="naehepraeferenz" class="java.lang.Double"><fact>new java.lang.Double(0.6)</fact></belief>
		<belief name="morgensStart" class="Integer"/>
		<belief name="abendsEnde" class="Integer"/>
		<belief name="wohnort" class="Vector2Double"/>
		<belief name="arbeitsort" class="Vector2Double"/>
		<!--<belief name="test" class="Double"><fact>new Double(2.0)</fact></belief>-->
	</beliefs>

	<goals>
		<achievegoal name="bewegungverwalten" exported="true"/>
	
		<achievegoal name="erreicheziel" exported="true">
			<parameter class="IVector2" name="ziel" exported="true"></parameter>
		</achievegoal>
		
		<achievegoal name="fussweg" exported="true"
				description="Agent entscheidet sich, zu Fuss zu laufen">
			<parameter class="IVector2" name="ziel" exported="true"></parameter>
		</achievegoal>
		
		<achievegoal name="radweg" exported="true"
				description="Agent entscheidet sich, die Strecke mit einem Rad zurueckzulegen">
			<parameter class="IVector2" name="ziel" exported="true"></parameter>
		</achievegoal>
		
		<achievegoal name="bahnfahrt" exported="true"
			description="Agent nutzt die Bahn">
			<parameter class="IVector2" name="ziel" exported="true"></parameter>
		</achievegoal>
	</goals>

	<plans>
		<plan name="gehzufuss">
			<parameter class="IVector2" name="ziel">
				<goalmapping ref="fussweg.ziel" />
			</parameter>
			<body class="GehZuFuss" />
			<trigger>
				<goal ref="fussweg" />
			</trigger>
		</plan>
		
		<plan name="nutzerad">
			<parameter class="IVector2" name="ziel">
				<goalmapping ref="radweg.ziel" />
			</parameter>
			<body class="FahreRad" />
			<trigger>
				<goal ref="radweg" />
			</trigger>
		</plan>

		<plan name="nutzebahn">
			<parameter class="IVector2" name="ziel">
				<goalmapping ref="bahnfahrt.ziel" />
			</parameter>
			<body class="NutzeBahn" />
			<trigger>
				<goal ref="bahnfahrt" />
			</trigger>
		</plan>

		<plan name="gehealtenwegplan" priority="2">
			<parameter class="IVector2" name="ziel">
				<goalmapping ref="erreicheziel.ziel" />
			</parameter>
			<precondition>Math.random()*$beliefbase.risikopraeferenz  &gt; 0.9 / (1+$beliefbase.weganzahl) </precondition>
			<body class="GeheAltenWegPlan"/>
			<trigger>
				<goal ref="erreicheziel"/>			
			</trigger>
		</plan>
		
		<plan name="sucheneuenwegplan" priority="1">
			<parameter class="IVector2" name="ziel">
				<goalmapping ref="erreicheziel.ziel" />
			</parameter>
			<body class="SucheNeuenWegPlan" />
			<trigger>
				<goal ref="erreicheziel" />
			</trigger>
		</plan>

		<plan name="zielwaehlplan">
			<body class="ZielWaehlPlan" />
			<trigger>
				<goal ref="bewegungverwalten" />
			</trigger>
		</plan>

	</plans>

	<events>
		<messageevent name="einsteigen" type="fipa" direction="send" description="Nachricht, die beim Ein- Aussteigen an den Verkehrsmittelagent gesendet wird">
			<parameter name="content" class="String"/>
	    </messageevent>
	</events>

	<configurations>
		<configuration name="default">
			<plans>
				<initialgoal ref="bewegungverwalten"/>
			</plans>
		</configuration>
	</configurations>
</agent>